
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "results/plot_mon_surrogate_GP.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_results_plot_mon_surrogate_GP.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_results_plot_mon_surrogate_GP.py:


LH2pac Surrogate model
===============

In this example,
we will build a surrogate model for the H2TurboFan problem using
a Gaussian Process Regressor, and some constraints related to 
the optimization of this model.

.. GENERATED FROM PYTHON SOURCE LINES 12-26

.. code-block:: default

    from gemseo.api import configure_logger
    from gemseo.api import create_scenario
    from gemseo.api import create_surrogate
    from gemseo.api import import_discipline
    from gemseo.mlearning.qual_measure.r2_measure import R2Measure
    from gemseo.mlearning.qual_measure.rmse_measure import RMSEMeasure
    from gemseo_mlearning.api import sample_discipline
    from discipline import H2TurboFan
    from project.source._results.plot_mon_design_space import lh2pacDesignSpace
    from marilib.utils import unit
    import matplotlib.pyplot as plt
    from numpy import array









.. GENERATED FROM PYTHON SOURCE LINES 27-28

.. code-block:: default

    configure_logger()




.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <RootLogger root (INFO)>



.. GENERATED FROM PYTHON SOURCE LINES 29-31

Firstly,
we instantiate the discipline

.. GENERATED FROM PYTHON SOURCE LINES 31-34

.. code-block:: default


    discipline = H2TurboFan()








.. GENERATED FROM PYTHON SOURCE LINES 35-36

Then, we instantiate the design space:

.. GENERATED FROM PYTHON SOURCE LINES 36-40

.. code-block:: default


    design_space = lh2pacDesignSpace()
    print(design_space)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Design space:
    +--------------+-------------+--------+-------------+-------+
    | name         | lower_bound | value  | upper_bound | type  |
    +--------------+-------------+--------+-------------+-------+
    | thrust       |    100000   | 125000 |    150000   | float |
    | bpr          |      5      |  8.5   |      12     | float |
    | area         |     120     |  160   |     200     | float |
    | aspect_ratio |      7      |  9.5   |      12     | float |
    +--------------+-------------+--------+-------------+-------+




.. GENERATED FROM PYTHON SOURCE LINES 41-43

Then,
we sample the discipline with an optimal LHS:

.. GENERATED FROM PYTHON SOURCE LINES 43-45

.. code-block:: default

    dataset = sample_discipline(discipline, design_space, output_names=["mtow","tofl","vapp", "vz_mcl","vz_mcr","oei_path","ttc","far"],algo_name= "OT_OPT_LHS", n_samples= 30)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

        INFO - 17:38:11:  
        INFO - 17:38:11: *** Start DOEScenario execution ***
        INFO - 17:38:11: DOEScenario
        INFO - 17:38:11:    Disciplines: H2TurboFan
        INFO - 17:38:11:    MDO formulation: DisciplinaryOpt
        INFO - 17:38:11: Optimization problem:
        INFO - 17:38:11:    minimize mtow(thrust, bpr, area, aspect_ratio)
        INFO - 17:38:11:    with respect to area, aspect_ratio, bpr, thrust
        INFO - 17:38:11:    over the design space:
        INFO - 17:38:11:    +--------------+-------------+--------+-------------+-------+
        INFO - 17:38:11:    | name         | lower_bound | value  | upper_bound | type  |
        INFO - 17:38:11:    +--------------+-------------+--------+-------------+-------+
        INFO - 17:38:11:    | thrust       |    100000   | 125000 |    150000   | float |
        INFO - 17:38:11:    | bpr          |      5      |  8.5   |      12     | float |
        INFO - 17:38:11:    | area         |     120     |  160   |     200     | float |
        INFO - 17:38:11:    | aspect_ratio |      7      |  9.5   |      12     | float |
        INFO - 17:38:11:    +--------------+-------------+--------+-------------+-------+
        INFO - 17:38:11: Solving optimization problem with algorithm OT_OPT_LHS:
        INFO - 17:38:11: Generation of OT_OPT_LHS DOE with OpenTURNS
        INFO - 17:38:11: ...   0%|          | 0/30 [00:00<?, ?it]
        INFO - 17:38:12: ...   3%|▎         | 1/30 [00:00<00:00, 44.45 it/sec, obj=8.71e+4]
        INFO - 17:38:13: ...   7%|▋         | 2/30 [00:01<00:01, 22.93 it/sec, obj=8.6e+4]
        INFO - 17:38:13: ...  10%|█         | 3/30 [00:02<00:01, 14.45 it/sec, obj=8.8e+4]
        INFO - 17:38:14: ...  13%|█▎        | 4/30 [00:02<00:02, 10.83 it/sec, obj=8.59e+4]
        INFO - 17:38:15: ...  17%|█▋        | 5/30 [00:03<00:02,  8.65 it/sec, obj=8.43e+4]
        INFO - 17:38:15: ...  20%|██        | 6/30 [00:04<00:03,  7.18 it/sec, obj=9.04e+4]
        INFO - 17:38:16: ...  23%|██▎       | 7/30 [00:04<00:03,  6.15 it/sec, obj=7.84e+4]
        INFO - 17:38:17: ...  27%|██▋       | 8/30 [00:05<00:04,  5.36 it/sec, obj=7.94e+4]
        INFO - 17:38:17: ...  30%|███       | 9/30 [00:06<00:04,  4.81 it/sec, obj=8.52e+4]
        INFO - 17:38:18: ...  33%|███▎      | 10/30 [00:07<00:04,  4.18 it/sec, obj=9.33e+4]
        INFO - 17:38:19: ...  37%|███▋      | 11/30 [00:07<00:05,  3.79 it/sec, obj=8.51e+4]
        INFO - 17:38:20: ...  40%|████      | 12/30 [00:08<00:05,  3.44 it/sec, obj=8.27e+4]
        INFO - 17:38:21: ...  43%|████▎     | 13/30 [00:09<00:05,  3.15 it/sec, obj=8.86e+4]
        INFO - 17:38:22: ...  47%|████▋     | 14/30 [00:10<00:05,  2.90 it/sec, obj=8.14e+4]
        INFO - 17:38:22: ...  50%|█████     | 15/30 [00:10<00:05,  2.74 it/sec, obj=8.51e+4]
        INFO - 17:38:23: ...  53%|█████▎    | 16/30 [00:11<00:05,  2.56 it/sec, obj=9.22e+4]
        INFO - 17:38:24: ...  57%|█████▋    | 17/30 [00:12<00:05,  2.41 it/sec, obj=8.57e+4]
        INFO - 17:38:24: ...  60%|██████    | 18/30 [00:13<00:05,  2.28 it/sec, obj=9.27e+4]
        INFO - 17:38:25: ...  63%|██████▎   | 19/30 [00:13<00:05,  2.16 it/sec, obj=8.18e+4]
        INFO - 17:38:26: ...  67%|██████▋   | 20/30 [00:14<00:04,  2.05 it/sec, obj=8.98e+4]
        INFO - 17:38:26: ...  70%|███████   | 21/30 [00:15<00:04,  1.97 it/sec, obj=8.81e+4]
        INFO - 17:38:27: ...  73%|███████▎  | 22/30 [00:15<00:04,  1.88 it/sec, obj=7.84e+4]
        INFO - 17:38:28: ...  77%|███████▋  | 23/30 [00:16<00:03,  1.78 it/sec, obj=7.82e+4]
        INFO - 17:38:29: ...  80%|████████  | 24/30 [00:17<00:03,  1.71 it/sec, obj=8.66e+4]
        INFO - 17:38:29: ...  83%|████████▎ | 25/30 [00:18<00:03,  1.65 it/sec, obj=8.57e+4]
        INFO - 17:38:31: ...  87%|████████▋ | 26/30 [00:19<00:02,  1.54 it/sec, obj=8.99e+4]
        INFO - 17:38:31: ...  90%|█████████ | 27/30 [00:20<00:02,  1.49 it/sec, obj=8.18e+4]
        INFO - 17:38:32: ...  93%|█████████▎| 28/30 [00:20<00:01,  1.44 it/sec, obj=8.04e+4]
        INFO - 17:38:33: ...  97%|█████████▋| 29/30 [00:21<00:00,  1.39 it/sec, obj=9.42e+4]
        INFO - 17:38:34: ... 100%|██████████| 30/30 [00:22<00:00,  1.34 it/sec, obj=8.45e+4]
        INFO - 17:38:34: ... 100%|██████████| 30/30 [00:22<00:00,  1.34 it/sec, obj=8.45e+4]
        INFO - 17:38:34: Optimization result:
        INFO - 17:38:34:    Optimizer info:
        INFO - 17:38:34:       Status: None
        INFO - 17:38:34:       Message: None
        INFO - 17:38:34:       Number of calls to the objective function by the optimizer: 30
        INFO - 17:38:34:    Solution:
        INFO - 17:38:34:       Objective: 78227.96380152939
        INFO - 17:38:34:       Design space:
        INFO - 17:38:34:       +--------------+-------------+-------------------+-------------+-------+
        INFO - 17:38:34:       | name         | lower_bound |       value       | upper_bound | type  |
        INFO - 17:38:34:       +--------------+-------------+-------------------+-------------+-------+
        INFO - 17:38:34:       | thrust       |    100000   | 104989.0047922888 |    150000   | float |
        INFO - 17:38:34:       | bpr          |      5      | 11.06963922133657 |      12     | float |
        INFO - 17:38:34:       | area         |     120     | 129.7460430732734 |     200     | float |
        INFO - 17:38:34:       | aspect_ratio |      7      | 7.879509020261423 |      12     | float |
        INFO - 17:38:34:       +--------------+-------------+-------------------+-------------+-------+
        INFO - 17:38:34: *** End DOEScenario execution (time: 0:00:22.414000) ***




.. GENERATED FROM PYTHON SOURCE LINES 46-47

before creating a surrogate discipline:

.. GENERATED FROM PYTHON SOURCE LINES 47-48

.. code-block:: default

    surrogate_discipline = create_surrogate("GaussianProcessRegressor", dataset)




.. rst-class:: sphx-glr-script-out

 .. code-block:: none

        INFO - 17:38:34: Build the surrogate discipline: GPR_H2TurboFan
        INFO - 17:38:34:    Dataset name: H2TurboFan
        INFO - 17:38:34:    Dataset size: 30
        INFO - 17:38:34:    Surrogate model: GaussianProcessRegressor
        INFO - 17:38:34: Use the surrogate discipline: GPR_H2TurboFan
        INFO - 17:38:34:    Inputs: area, aspect_ratio, bpr, thrust
        INFO - 17:38:34:    Outputs: far, mtow, oei_path, tofl, ttc, vapp, vz_mcl, vz_mcr
        INFO - 17:38:34:    Jacobian: use finite differences




.. GENERATED FROM PYTHON SOURCE LINES 49-50

and using it for prediction:

.. GENERATED FROM PYTHON SOURCE LINES 50-53

.. code-block:: default

    surrogate_discipline.execute({"x": array([1.])})
    print(surrogate_discipline.cache.last_entry)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    CacheEntry(inputs={'area': array([160.18380563]), 'aspect_ratio': array([9.49381407]), 'bpr': array([8.49475414]), 'thrust': array([125082.91397443])}, outputs={'far': array([13.1159489]), 'mtow': array([84044.77827349]), 'oei_path': array([0.01727863]), 'tofl': array([1980.4146472]), 'ttc': array([1035.09796617]), 'vapp': array([70.4722089]), 'vz_mcl': array([5.60846152]), 'vz_mcr': array([1.19458185])}, jacobian={})




.. GENERATED FROM PYTHON SOURCE LINES 54-55

optimization of the surrogate model

.. GENERATED FROM PYTHON SOURCE LINES 55-66

.. code-block:: default


    #first we create a scenario
    scenario = create_scenario([discipline], "DisciplinaryOpt", "mtow", design_space)
    scenario.add_constraint("tofl", "ineq", positive=False, value = 2200.)
    scenario.add_constraint("vapp", "ineq", positive=False, value = unit.mps_kt(137.))
    scenario.add_constraint("vz_mcl", "ineq", positive=True, value = unit.mps_ftpmin(300.)) #ftpmin_mps
    scenario.add_constraint("vz_mcr", "ineq", positive=True, value = unit.mps_ftpmin(0.))
    scenario.add_constraint("oei_path", "ineq", positive=True, value=0.0011)
    scenario.add_constraint("ttc", "ineq", positive=False, value=unit.s_min(25.)) # min_s
    scenario.add_constraint("far", "ineq", positive=False, value=13.4)








.. GENERATED FROM PYTHON SOURCE LINES 67-68

before executing it with a gradient-free optimizer:

.. GENERATED FROM PYTHON SOURCE LINES 68-70

.. code-block:: default

    scenario.execute({"algo": "NLOPT_COBYLA", "max_iter": 1000})





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

        INFO - 17:38:34:  
        INFO - 17:38:34: *** Start MDOScenario execution ***
        INFO - 17:38:34: MDOScenario
        INFO - 17:38:34:    Disciplines: H2TurboFan
        INFO - 17:38:34:    MDO formulation: DisciplinaryOpt
        INFO - 17:38:34: Optimization problem:
        INFO - 17:38:34:    minimize mtow(thrust, bpr, area, aspect_ratio)
        INFO - 17:38:34:    with respect to area, aspect_ratio, bpr, thrust
        INFO - 17:38:34:    subject to constraints:
        INFO - 17:38:34:       tofl(thrust, bpr, area, aspect_ratio) <= 2200.0
        INFO - 17:38:34:       vapp(thrust, bpr, area, aspect_ratio) <= 70.47888888888889
        INFO - 17:38:34:       vz_mcl(thrust, bpr, area, aspect_ratio) >= 1.524
        INFO - 17:38:34:       vz_mcr(thrust, bpr, area, aspect_ratio) >= 0.0
        INFO - 17:38:34:       oei_path(thrust, bpr, area, aspect_ratio) >= 0.0011
        INFO - 17:38:34:       ttc(thrust, bpr, area, aspect_ratio) <= 1500.0
        INFO - 17:38:34:       far(thrust, bpr, area, aspect_ratio) <= 13.4
        INFO - 17:38:34:    over the design space:
        INFO - 17:38:34:    +--------------+-------------+-------------------+-------------+-------+
        INFO - 17:38:34:    | name         | lower_bound |       value       | upper_bound | type  |
        INFO - 17:38:34:    +--------------+-------------+-------------------+-------------+-------+
        INFO - 17:38:34:    | thrust       |    100000   | 104989.0047922888 |    150000   | float |
        INFO - 17:38:34:    | bpr          |      5      | 11.06963922133657 |      12     | float |
        INFO - 17:38:34:    | area         |     120     | 129.7460430732734 |     200     | float |
        INFO - 17:38:34:    | aspect_ratio |      7      | 7.879509020261423 |      12     | float |
        INFO - 17:38:34:    +--------------+-------------+-------------------+-------------+-------+
        INFO - 17:38:34: Solving optimization problem with algorithm NLOPT_COBYLA:
        INFO - 17:38:34: ...   0%|          | 0/1000 [00:00<?, ?it]
        INFO - 17:38:35: ...   0%|          | 1/1000 [00:00<00:00, 1159.03 it/sec]
        INFO - 17:38:35: ...   0%|          | 2/1000 [00:01<00:01, 632.74 it/sec, obj=7.9e+4]
        INFO - 17:38:36: ...   0%|          | 3/1000 [00:02<00:02, 416.33 it/sec, obj=7.98e+4]
        INFO - 17:38:37: ...   0%|          | 4/1000 [00:03<00:03, 304.42 it/sec, obj=8.04e+4]
        INFO - 17:38:38: ...   0%|          | 5/1000 [00:04<00:03, 249.04 it/sec, obj=7.71e+4]
        INFO - 17:38:39: ...   1%|          | 6/1000 [00:04<00:04, 210.60 it/sec, obj=7.92e+4]
        INFO - 17:38:39: ...   1%|          | 7/1000 [00:05<00:05, 183.15 it/sec, obj=7.76e+4]
        INFO - 17:38:40: ...   1%|          | 8/1000 [00:06<00:06, 162.08 it/sec, obj=7.83e+4]
        INFO - 17:38:41: ...   1%|          | 9/1000 [00:06<00:06, 145.28 it/sec, obj=7.76e+4]
        INFO - 17:38:41: ...   1%|          | 10/1000 [00:07<00:07, 131.63 it/sec, obj=7.83e+4]
        INFO - 17:38:42: ...   1%|          | 11/1000 [00:08<00:08, 120.34 it/sec, obj=7.95e+4]
        INFO - 17:38:43: ...   1%|          | 12/1000 [00:09<00:08, 110.85 it/sec, obj=7.93e+4]
        INFO - 17:38:44: ...   1%|▏         | 13/1000 [00:09<00:09, 102.74 it/sec, obj=7.93e+4]
        INFO - 17:38:44: ...   1%|▏         | 14/1000 [00:10<00:10, 95.83 it/sec, obj=7.95e+4]
        INFO - 17:38:45: ...   2%|▏         | 15/1000 [00:11<00:10, 89.65 it/sec, obj=8.02e+4]
        INFO - 17:38:46: ...   2%|▏         | 16/1000 [00:11<00:11, 84.21 it/sec, obj=7.97e+4]
        INFO - 17:38:46: ...   2%|▏         | 17/1000 [00:12<00:12, 79.43 it/sec, obj=8.02e+4]
        INFO - 17:38:47: ...   2%|▏         | 18/1000 [00:13<00:13, 75.15 it/sec, obj=7.97e+4]
        INFO - 17:38:48: ...   2%|▏         | 19/1000 [00:14<00:13, 71.34 it/sec, obj=7.94e+4]
        INFO - 17:38:49: ...   2%|▏         | 20/1000 [00:14<00:14, 67.89 it/sec, obj=7.99e+4]
        INFO - 17:38:49: ...   2%|▏         | 21/1000 [00:15<00:15, 64.75 it/sec, obj=7.94e+4]
        INFO - 17:38:50: ...   2%|▏         | 22/1000 [00:16<00:15, 61.84 it/sec, obj=7.94e+4]
        INFO - 17:38:51: ...   2%|▏         | 23/1000 [00:16<00:16, 59.24 it/sec, obj=7.99e+4]
        INFO - 17:38:51: ...   2%|▏         | 24/1000 [00:17<00:17, 56.82 it/sec, obj=7.94e+4]
        INFO - 17:38:52: ...   2%|▎         | 25/1000 [00:18<00:17, 54.61 it/sec, obj=7.95e+4]
        INFO - 17:38:53: ...   3%|▎         | 26/1000 [00:19<00:18, 52.55 it/sec, obj=7.99e+4]
        INFO - 17:38:54: ...   3%|▎         | 27/1000 [00:19<00:19, 50.63 it/sec, obj=7.95e+4]
        INFO - 17:38:54: ...   3%|▎         | 28/1000 [00:20<00:19, 48.87 it/sec, obj=8.01e+4]
        INFO - 17:38:55: ...   3%|▎         | 29/1000 [00:21<00:20, 47.21 it/sec, obj=7.94e+4]
        INFO - 17:38:56: ...   3%|▎         | 30/1000 [00:21<00:21, 45.68 it/sec, obj=7.96e+4]
        INFO - 17:38:56: ...   3%|▎         | 31/1000 [00:22<00:21, 44.24 it/sec, obj=7.95e+4]
        INFO - 17:38:57: ...   3%|▎         | 32/1000 [00:23<00:22, 42.87 it/sec, obj=7.96e+4]
        INFO - 17:38:58: ...   3%|▎         | 33/1000 [00:24<00:23, 41.59 it/sec, obj=7.94e+4]
        INFO - 17:38:59: ...   3%|▎         | 34/1000 [00:24<00:23, 40.39 it/sec, obj=7.97e+4]
        INFO - 17:38:59: ...   4%|▎         | 35/1000 [00:25<00:24, 39.24 it/sec, obj=7.95e+4]
        INFO - 17:39:00: ...   4%|▎         | 36/1000 [00:26<00:25, 38.16 it/sec, obj=7.97e+4]
        INFO - 17:39:01: ...   4%|▎         | 37/1000 [00:26<00:25, 37.15 it/sec, obj=7.95e+4]
        INFO - 17:39:02: ...   4%|▍         | 38/1000 [00:27<00:26, 36.14 it/sec, obj=7.97e+4]
        INFO - 17:39:02: ...   4%|▍         | 39/1000 [00:28<00:27, 35.15 it/sec, obj=7.95e+4]
        INFO - 17:39:03: ...   4%|▍         | 40/1000 [00:29<00:28, 34.25 it/sec, obj=7.94e+4]
        INFO - 17:39:04: ...   4%|▍         | 41/1000 [00:29<00:28, 33.37 it/sec, obj=7.95e+4]
        INFO - 17:39:05: ...   4%|▍         | 42/1000 [00:30<00:29, 32.56 it/sec, obj=7.94e+4]
        INFO - 17:39:05: ...   4%|▍         | 43/1000 [00:31<00:30, 31.80 it/sec, obj=7.94e+4]
        INFO - 17:39:06: ...   4%|▍         | 44/1000 [00:32<00:30, 31.03 it/sec, obj=7.94e+4]
        INFO - 17:39:07: ...   4%|▍         | 45/1000 [00:32<00:31, 30.33 it/sec, obj=7.94e+4]
        INFO - 17:39:08: ...   5%|▍         | 46/1000 [00:33<00:32, 29.61 it/sec, obj=7.95e+4]
        INFO - 17:39:08: ...   5%|▍         | 47/1000 [00:34<00:32, 28.92 it/sec, obj=7.94e+4]
        INFO - 17:39:09: ...   5%|▍         | 48/1000 [00:35<00:33, 28.27 it/sec, obj=7.94e+4]
        INFO - 17:39:10: ...   5%|▍         | 49/1000 [00:36<00:34, 27.66 it/sec, obj=7.94e+4]
        INFO - 17:39:11: ...   5%|▌         | 50/1000 [00:36<00:35, 27.12 it/sec, obj=7.94e+4]
        INFO - 17:39:11: ...   5%|▌         | 51/1000 [00:37<00:35, 26.60 it/sec, obj=7.94e+4]
        INFO - 17:39:12: ...   5%|▌         | 52/1000 [00:38<00:36, 26.09 it/sec, obj=7.94e+4]
        INFO - 17:39:13: ...   5%|▌         | 53/1000 [00:39<00:36, 25.60 it/sec, obj=7.94e+4]
        INFO - 17:39:14: ...   5%|▌         | 54/1000 [00:39<00:37, 25.14 it/sec, obj=7.95e+4]
        INFO - 17:39:14: ...   6%|▌         | 55/1000 [00:40<00:38, 24.69 it/sec, obj=7.94e+4]
        INFO - 17:39:15: ...   6%|▌         | 56/1000 [00:41<00:38, 24.26 it/sec, obj=7.94e+4]
        INFO - 17:39:16: ...   6%|▌         | 57/1000 [00:41<00:39, 23.84 it/sec, obj=7.94e+4]
        INFO - 17:39:17: ...   6%|▌         | 58/1000 [00:42<00:40, 23.44 it/sec, obj=7.94e+4]
        INFO - 17:39:17: ...   6%|▌         | 59/1000 [00:43<00:40, 23.05 it/sec, obj=7.94e+4]
        INFO - 17:39:18: ...   6%|▌         | 60/1000 [00:44<00:41, 22.68 it/sec, obj=7.94e+4]
        INFO - 17:39:19: ...   6%|▌         | 61/1000 [00:44<00:42, 22.31 it/sec, obj=7.94e+4]
        INFO - 17:39:19: ...   6%|▌         | 62/1000 [00:45<00:42, 21.96 it/sec, obj=7.94e+4]
        INFO - 17:39:20: ...   6%|▋         | 63/1000 [00:46<00:43, 21.62 it/sec, obj=7.94e+4]
        INFO - 17:39:21: ...   6%|▋         | 64/1000 [00:46<00:43, 21.29 it/sec, obj=7.94e+4]
        INFO - 17:39:22: ...   6%|▋         | 65/1000 [00:47<00:44, 20.97 it/sec, obj=7.94e+4]
        INFO - 17:39:22: ...   7%|▋         | 66/1000 [00:48<00:45, 20.66 it/sec, obj=7.94e+4]
        INFO - 17:39:23: ...   7%|▋         | 67/1000 [00:49<00:45, 20.35 it/sec, obj=7.94e+4]
        INFO - 17:39:24: ...   7%|▋         | 68/1000 [00:49<00:46, 20.06 it/sec, obj=7.94e+4]
        INFO - 17:39:24: ...   7%|▋         | 69/1000 [00:50<00:47, 19.77 it/sec, obj=7.94e+4]
        INFO - 17:39:25: ...   7%|▋         | 70/1000 [00:51<00:47, 19.49 it/sec, obj=7.94e+4]
        INFO - 17:39:26: ...   7%|▋         | 71/1000 [00:52<00:48, 19.22 it/sec, obj=7.94e+4]
        INFO - 17:39:27: ...   7%|▋         | 72/1000 [00:52<00:48, 18.96 it/sec, obj=7.94e+4]
        INFO - 17:39:27: ...   7%|▋         | 73/1000 [00:53<00:49, 18.71 it/sec, obj=7.94e+4]
        INFO - 17:39:28: ...   7%|▋         | 74/1000 [00:54<00:50, 18.46 it/sec, obj=7.94e+4]
        INFO - 17:39:29: ...   8%|▊         | 75/1000 [00:54<00:50, 18.22 it/sec, obj=7.94e+4]
        INFO - 17:39:29: ...   8%|▊         | 76/1000 [00:55<00:51, 17.98 it/sec, obj=7.94e+4]
        INFO - 17:39:30: ...   8%|▊         | 77/1000 [00:56<00:51, 17.75 it/sec, obj=7.94e+4]
        INFO - 17:39:31: ...   8%|▊         | 78/1000 [00:57<00:52, 17.53 it/sec, obj=7.94e+4]
        INFO - 17:39:32: ...   8%|▊         | 79/1000 [00:57<00:53, 17.31 it/sec, obj=7.94e+4]
        INFO - 17:39:32: ...   8%|▊         | 80/1000 [00:58<00:53, 17.10 it/sec, obj=7.94e+4]
        INFO - 17:39:33: ...   8%|▊         | 81/1000 [00:59<00:54, 16.89 it/sec, obj=7.94e+4]
        INFO - 17:39:33: ...   8%|▊         | 81/1000 [00:59<00:54, 16.89 it/sec, obj=7.94e+4]
        INFO - 17:39:33: Optimization result:
        INFO - 17:39:33:    Optimizer info:
        INFO - 17:39:33:       Status: None
        INFO - 17:39:33:       Message: Successive iterates of the objective function are closer than ftol_rel or ftol_abs. GEMSEO Stopped the driver
        INFO - 17:39:33:       Number of calls to the objective function by the optimizer: 82
        INFO - 17:39:33:    Solution:
        INFO - 17:39:33:       The solution is feasible.
        INFO - 17:39:33:       Objective: 79420.33315375968
        INFO - 17:39:33:       Standardized constraints:
        INFO - 17:39:33:          -oei_path + 0.0011 = -0.015853687699288556
        INFO - 17:39:33:          -vz_mcl + 1.524 = -2.944059508570586
        INFO - 17:39:33:          -vz_mcr - +0.0 = -0.21389744812691544
        INFO - 17:39:33:          far - 13.4 = -0.7501760375767486
        INFO - 17:39:33:          tofl - 2200.0 = 4.404566607263405e-05
        INFO - 17:39:33:          ttc - 1500.0 = -297.53374462312036
        INFO - 17:39:33:          vapp - 70.47888888888889 = 3.4079414490406634e-07
        INFO - 17:39:33:       Design space:
        INFO - 17:39:33:       +--------------+-------------+-------------------+-------------+-------+
        INFO - 17:39:33:       | name         | lower_bound |       value       | upper_bound | type  |
        INFO - 17:39:33:       +--------------+-------------+-------------------+-------------+-------+
        INFO - 17:39:33:       | thrust       |    100000   | 110659.2075829064 |    150000   | float |
        INFO - 17:39:33:       | bpr          |      5      |         12        |      12     | float |
        INFO - 17:39:33:       | area         |     120     | 152.8365416329551 |     200     | float |
        INFO - 17:39:33:       | aspect_ratio |      7      | 10.98032109606376 |      12     | float |
        INFO - 17:39:33:       +--------------+-------------+-------------------+-------------+-------+
        INFO - 17:39:33: *** End MDOScenario execution (time: 0:00:59.224686) ***

    {'max_iter': 1000, 'algo': 'NLOPT_COBYLA'}



.. GENERATED FROM PYTHON SOURCE LINES 71-73

Lastly,
we can plot the optimization history:

.. GENERATED FROM PYTHON SOURCE LINES 73-76

.. code-block:: default

    scenario.post_process("OptHistoryView", save=True, show=True, file_path="opt_history_GP")
    plt.show()








.. GENERATED FROM PYTHON SOURCE LINES 77-79

The underlying regression model can also be assessed,
with the R2 measure for instance:

.. GENERATED FROM PYTHON SOURCE LINES 79-84

.. code-block:: default

    r2 = R2Measure(surrogate_discipline.regression_model, True)
    print("r2 de l'evaluate_learn",r2.evaluate_learn())  # learning measure
    print("\n\n")
    print("r2 de l'evaluate_kfolds",r2.evaluate_kfolds())  # k-folds cross-validation measure
    print("\n\n")




.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    r2 de l'evaluate_learn [1. 1. 1. 1. 1. 1. 1. 1.]



    r2 de l'evaluate_kfolds [0.98507959 0.9896702  0.99393103 0.78054084 0.89823446 0.99172502
     0.99386419 0.99208803]







.. GENERATED FROM PYTHON SOURCE LINES 85-86

or with the root mean squared error:

.. GENERATED FROM PYTHON SOURCE LINES 86-99

.. code-block:: default

    rmse = RMSEMeasure(surrogate_discipline.regression_model, True)
    print("rmse de evaluate_learn",rmse.evaluate_learn())
    print("\n\n")
    print("rmse de evaluate_kfolds",rmse.evaluate_kfolds())
    print("\n\n")

    surrogate_discipline.serialize("mon_surrogate.pkl")

    discipline = import_discipline("mon_surrogate.pkl")
    discipline.execute({"x": array([1.])})
    print(discipline.get_output_data())






.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    rmse de evaluate_learn [7.16560253e-09 6.21331331e-05 7.26706053e-11 2.53311848e-05
     7.35982491e-06 4.25068411e-08 1.63946570e-08 1.90329851e-08]



    rmse de evaluate_kfolds [5.18782188e-02 4.52036031e+02 6.45008721e-04 3.16619453e+02
     1.13137014e+02 3.75028816e-01 1.43464746e-01 1.66197536e-01]



    {'far': array([13.1159489]), 'mtow': array([84044.77827349]), 'oei_path': array([0.01727863]), 'tofl': array([1980.4146472]), 'ttc': array([1035.09796617]), 'vapp': array([70.4722089]), 'vz_mcl': array([5.60846152]), 'vz_mcr': array([1.19458185])}





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 1 minutes  25.126 seconds)


.. _sphx_glr_download_results_plot_mon_surrogate_GP.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example


    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_mon_surrogate_GP.py <plot_mon_surrogate_GP.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_mon_surrogate_GP.ipynb <plot_mon_surrogate_GP.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_

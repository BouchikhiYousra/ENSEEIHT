
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "results/plot_mon_optimization.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_results_plot_mon_optimization.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_results_plot_mon_optimization.py:


LH2pac Optimization 30 iterations
============

We want to optimize our real model through 30 iterations which is the maximum of evaluations allowed for our model.

.. GENERATED FROM PYTHON SOURCE LINES 8-16

.. code-block:: default


    from gemseo.api import configure_logger
    from discipline import H2TurboFan
    from plot_mon_design_space import lh2pacDesignSpace
    from gemseo.api import create_scenario
    from matplotlib import pyplot as plt
    from marilib.utils import unit








.. GENERATED FROM PYTHON SOURCE LINES 17-19

Before starting,
we activate the logger as an optimization process logs meaningful information.

.. GENERATED FROM PYTHON SOURCE LINES 19-21

.. code-block:: default

    configure_logger()





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <RootLogger root (INFO)>



.. GENERATED FROM PYTHON SOURCE LINES 22-24

Firstly,
we define the discipline computing the h2turbofan

.. GENERATED FROM PYTHON SOURCE LINES 24-26

.. code-block:: default

    discipline = H2TurboFan()








.. GENERATED FROM PYTHON SOURCE LINES 27-28

Then, we instantiate the design space:

.. GENERATED FROM PYTHON SOURCE LINES 28-31

.. code-block:: default

    design_space = lh2pacDesignSpace()
    print(design_space)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Design space:
    +--------------+-------------+--------+-------------+-------+
    | name         | lower_bound | value  | upper_bound | type  |
    +--------------+-------------+--------+-------------+-------+
    | thrust       |    100000   | 125000 |    150000   | float |
    | bpr          |      5      |  8.5   |      12     | float |
    | area         |     120     |  160   |     200     | float |
    | aspect_ratio |      7      |  9.5   |      12     | float |
    +--------------+-------------+--------+-------------+-------+




.. GENERATED FROM PYTHON SOURCE LINES 32-34

Thirdly,
we put these elements together in a scenario

.. GENERATED FROM PYTHON SOURCE LINES 34-45

.. code-block:: default


    scenario = create_scenario([discipline], "DisciplinaryOpt", "mtow", design_space)
    scenario.add_constraint("tofl", "ineq", positive=False, value = 2200.)
    scenario.add_constraint("vapp", "ineq", positive=False, value = unit.mps_kt(137.))
    scenario.add_constraint("vz_mcl", "ineq", positive=True, value = unit.mps_ftpmin(300.))
    scenario.add_constraint("vz_mcr", "ineq", positive=True, value = unit.mps_ftpmin(0.))
    scenario.add_constraint("oei_path", "ineq", positive=True, value=0.0011)
    scenario.add_constraint("ttc", "ineq", positive=False, value=unit.s_min(25.)) 
    scenario.add_constraint("far", "ineq", positive=False, value=13.4)









.. GENERATED FROM PYTHON SOURCE LINES 46-47

before executing it with a gradient-free optimizer:

.. GENERATED FROM PYTHON SOURCE LINES 47-49

.. code-block:: default

    scenario.execute({"algo": "NLOPT_COBYLA", "max_iter": 30})





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

        INFO - 21:38:56:  
        INFO - 21:38:56: *** Start MDOScenario execution ***
        INFO - 21:38:56: MDOScenario
        INFO - 21:38:56:    Disciplines: H2TurboFan
        INFO - 21:38:56:    MDO formulation: DisciplinaryOpt
        INFO - 21:38:56: Optimization problem:
        INFO - 21:38:56:    minimize mtow(thrust, bpr, area, aspect_ratio)
        INFO - 21:38:56:    with respect to area, aspect_ratio, bpr, thrust
        INFO - 21:38:56:    subject to constraints:
        INFO - 21:38:56:       tofl(thrust, bpr, area, aspect_ratio) <= 2200.0
        INFO - 21:38:56:       vapp(thrust, bpr, area, aspect_ratio) <= 70.47888888888889
        INFO - 21:38:56:       vz_mcl(thrust, bpr, area, aspect_ratio) >= 1.524
        INFO - 21:38:56:       vz_mcr(thrust, bpr, area, aspect_ratio) >= 0.0
        INFO - 21:38:56:       oei_path(thrust, bpr, area, aspect_ratio) >= 0.0011
        INFO - 21:38:56:       ttc(thrust, bpr, area, aspect_ratio) <= 1500.0
        INFO - 21:38:56:       far(thrust, bpr, area, aspect_ratio) <= 13.4
        INFO - 21:38:56:    over the design space:
        INFO - 21:38:56:    +--------------+-------------+--------+-------------+-------+
        INFO - 21:38:56:    | name         | lower_bound | value  | upper_bound | type  |
        INFO - 21:38:56:    +--------------+-------------+--------+-------------+-------+
        INFO - 21:38:56:    | thrust       |    100000   | 125000 |    150000   | float |
        INFO - 21:38:56:    | bpr          |      5      |  8.5   |      12     | float |
        INFO - 21:38:56:    | area         |     120     |  160   |     200     | float |
        INFO - 21:38:56:    | aspect_ratio |      7      |  9.5   |      12     | float |
        INFO - 21:38:56:    +--------------+-------------+--------+-------------+-------+
        INFO - 21:38:56: Solving optimization problem with algorithm NLOPT_COBYLA:
        INFO - 21:38:56: ...   0%|          | 0/30 [00:00<?, ?it]
        INFO - 21:38:57: ...   3%|▎         | 1/30 [00:00<00:00, 32.86 it/sec]
        INFO - 21:38:57: ...   7%|▋         | 2/30 [00:01<00:01, 18.28 it/sec, obj=8.5e+4]
        INFO - 21:38:58: ...  10%|█         | 3/30 [00:02<00:02, 12.69 it/sec, obj=8.26e+4]
        INFO - 21:38:59: ...  13%|█▎        | 4/30 [00:03<00:02,  9.99 it/sec, obj=8.54e+4]
        INFO - 21:38:59: ...  17%|█▋        | 5/30 [00:03<00:03,  8.06 it/sec, obj=8.23e+4]
        INFO - 21:39:00: ...  20%|██        | 6/30 [00:04<00:03,  6.75 it/sec, obj=8.01e+4]
        INFO - 21:39:01: ...  23%|██▎       | 7/30 [00:05<00:03,  5.83 it/sec, obj=8.04e+4]
        INFO - 21:39:01: ...  27%|██▋       | 8/30 [00:05<00:04,  5.11 it/sec, obj=7.92e+4]
        INFO - 21:39:02: ...  30%|███       | 9/30 [00:06<00:04,  4.56 it/sec, obj=7.94e+4]
        INFO - 21:39:03: ...  33%|███▎      | 10/30 [00:07<00:04,  4.12 it/sec, obj=7.95e+4]
        INFO - 21:39:04: ...  37%|███▋      | 11/30 [00:08<00:05,  3.74 it/sec, obj=8.03e+4]
        INFO - 21:39:04: ...  40%|████      | 12/30 [00:08<00:05,  3.43 it/sec, obj=8.11e+4]
        INFO - 21:39:05: ...  43%|████▎     | 13/30 [00:09<00:05,  3.17 it/sec, obj=8.08e+4]
        INFO - 21:39:06: ...  47%|████▋     | 14/30 [00:10<00:05,  2.94 it/sec, obj=8.05e+4]
        INFO - 21:39:07: ...  50%|█████     | 15/30 [00:10<00:05,  2.75 it/sec, obj=8.09e+4]
        INFO - 21:39:07: ...  53%|█████▎    | 16/30 [00:11<00:05,  2.58 it/sec, obj=8.09e+4]
        INFO - 21:39:08: ...  57%|█████▋    | 17/30 [00:12<00:05,  2.43 it/sec, obj=8.04e+4]
        INFO - 21:39:09: ...  60%|██████    | 18/30 [00:13<00:05,  2.29 it/sec, obj=8.23e+4]
        INFO - 21:39:09: ...  63%|██████▎   | 19/30 [00:13<00:05,  2.17 it/sec, obj=7.99e+4]
        INFO - 21:39:10: ...  67%|██████▋   | 20/30 [00:14<00:04,  2.07 it/sec, obj=8.01e+4]
        INFO - 21:39:11: ...  70%|███████   | 21/30 [00:15<00:04,  1.97 it/sec, obj=7.95e+4]
        INFO - 21:39:12: ...  73%|███████▎  | 22/30 [00:15<00:04,  1.88 it/sec, obj=7.96e+4]
        INFO - 21:39:12: ...  77%|███████▋  | 23/30 [00:16<00:03,  1.80 it/sec, obj=7.94e+4]
        INFO - 21:39:13: ...  80%|████████  | 24/30 [00:17<00:03,  1.72 it/sec, obj=7.98e+4]
        INFO - 21:39:14: ...  83%|████████▎ | 25/30 [00:18<00:03,  1.65 it/sec, obj=7.94e+4]
        INFO - 21:39:15: ...  87%|████████▋ | 26/30 [00:18<00:02,  1.58 it/sec, obj=7.94e+4]
        INFO - 21:39:15: ...  90%|█████████ | 27/30 [00:19<00:01,  1.52 it/sec, obj=7.96e+4]
        INFO - 21:39:16: ...  93%|█████████▎| 28/30 [00:20<00:01,  1.47 it/sec, obj=7.94e+4]
        INFO - 21:39:17: ...  97%|█████████▋| 29/30 [00:21<00:00,  1.42 it/sec, obj=7.95e+4]
        INFO - 21:39:17: ... 100%|██████████| 30/30 [00:21<00:00,  1.37 it/sec, obj=7.94e+4]
        INFO - 21:39:17: ... 100%|██████████| 30/30 [00:21<00:00,  1.37 it/sec, obj=7.94e+4]
        INFO - 21:39:17: Optimization result:
        INFO - 21:39:17:    Optimizer info:
        INFO - 21:39:17:       Status: None
        INFO - 21:39:17:       Message: Maximum number of iterations reached. GEMSEO Stopped the driver
        INFO - 21:39:17:       Number of calls to the objective function by the optimizer: 32
        INFO - 21:39:17:    Solution:
        INFO - 21:39:17:       The solution is feasible.
        INFO - 21:39:17:       Objective: 79421.66075206609
        INFO - 21:39:17:       Standardized constraints:
        INFO - 21:39:17:          -oei_path + 0.0011 = -0.01595656345448619
        INFO - 21:39:17:          -vz_mcl + 1.524 = -2.955571226337196
        INFO - 21:39:17:          -vz_mcr - +0.0 = -0.23030183251615854
        INFO - 21:39:17:          far - 13.4 = -0.7530379388698432
        INFO - 21:39:17:          tofl - 2200.0 = -0.06961047228378447
        INFO - 21:39:17:          ttc - 1500.0 = -299.39928117256954
        INFO - 21:39:17:          vapp - 70.47888888888889 = -0.0009292271947316522
        INFO - 21:39:17:       Design space:
        INFO - 21:39:17:       +--------------+-------------+-------------------+-------------+-------+
        INFO - 21:39:17:       | name         | lower_bound |       value       | upper_bound | type  |
        INFO - 21:39:17:       +--------------+-------------+-------------------+-------------+-------+
        INFO - 21:39:17:       | thrust       |    100000   | 110656.1426932268 |    150000   | float |
        INFO - 21:39:17:       | bpr          |      5      |         12        |      12     | float |
        INFO - 21:39:17:       | area         |     120     | 152.8528956984277 |     200     | float |
        INFO - 21:39:17:       | aspect_ratio |      7      |  11.0336553970024 |      12     | float |
        INFO - 21:39:17:       +--------------+-------------+-------------------+-------------+-------+
        INFO - 21:39:17: *** End MDOScenario execution (time: 0:00:21.871442) ***

    {'max_iter': 30, 'algo': 'NLOPT_COBYLA'}



.. GENERATED FROM PYTHON SOURCE LINES 50-52

Lastly,
we can plot the optimization history:

.. GENERATED FROM PYTHON SOURCE LINES 52-54

.. code-block:: default

    scenario.post_process("OptHistoryView", save=False, show=False, \
        file_path = "H2TurboFan30")
    plt.show()


.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /results/images/sphx_glr_plot_mon_optimization_001.png
         :alt: Evolution of the optimization variables
         :srcset: /results/images/sphx_glr_plot_mon_optimization_001.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /results/images/sphx_glr_plot_mon_optimization_002.png
         :alt: Evolution of the objective value
         :srcset: /results/images/sphx_glr_plot_mon_optimization_002.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /results/images/sphx_glr_plot_mon_optimization_003.png
         :alt: Distance to the optimum
         :srcset: /results/images/sphx_glr_plot_mon_optimization_003.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /results/images/sphx_glr_plot_mon_optimization_004.png
         :alt: Evolution of the inequality constraints
         :srcset: /results/images/sphx_glr_plot_mon_optimization_004.png
         :class: sphx-glr-multi-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  22.341 seconds)


.. _sphx_glr_download_results_plot_mon_optimization.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example


    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_mon_optimization.py <plot_mon_optimization.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_mon_optimization.ipynb <plot_mon_optimization.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
